class BRUpload{constructor(t,e,i){this.name=t,this.component=e,this._inputElement=this.component.querySelector(".upload-input"),this._fileList=this.component.querySelector(".upload-list"),this._btnUpload=this.component.querySelector(".upload-button"),this._fileArray=[],this._uploadFiles=i,this._setBehavior()}_setBehavior(){this.component.addEventListener("dragenter",t=>{this._drag(t)},!1),this.component.addEventListener("dragover",t=>{this._drag(t)},!1),this.component.addEventListener("dragleave",t=>{this._onDragEnd(t)},!1),this.component.addEventListener("dragend",t=>{this._onDragEnd(t)},!1),this.component.addEventListener("drop",t=>{this._drop(t)},!1),this._btnUpload&&this._btnUpload.addEventListener("click",t=>{this._clickUpload()},!1),this._inputElement&&(this._fileArray=Array.from(this._inputElement.files),this._inputElement.addEventListener("change",t=>{this._handleFiles(t)},!1))}_clickUpload(){this._inputElement.click()}_drag(t){t.stopPropagation(),t.preventDefault(),this._btnUpload.classList.add("bg-support-01"),this._btnUpload.classList.add("text-secondary-01")}_drop(t){t.stopPropagation(),t.preventDefault(),this._btnUpload.className=this._btnUpload.className.replace(/\bbg-support-01\b/g,""),this._btnUpload.className=this._btnUpload.className.replace(/\btext-secondary-01\b/g,"");const e=t.dataTransfer,{files:i}=e;this._handleFiles(i)}_onDragEnd(t){t.stopPropagation(),t.preventDefault(),this._btnUpload.className=this._btnUpload.className.replace(/\bbg-support-01\b/g,""),this._btnUpload.className=this._btnUpload.className.replace(/\btext-secondary-01\b/g,"")}_handleFiles(t){const e=t.length?Array.from(t):Array.from(this._inputElement.files);this._fileArray=this._fileArray.concat(e),this._updateFileList()}_updateFileList(){if(this._fileArray.length){this._fileList.innerHTML="";for(let t=0;t<this._fileArray.length;t++)if("nowait"in this._fileArray[t])this._fileArray[t].nowait&&this._renderItem(t);else{const e=document.createElement("div");e.setAttribute("sm",""),e.classList.add("my-3"),e.setAttribute("loading",""),this._fileList.appendChild(e),this._uploadFiles()&&this._uploadFiles().then(()=>{this._fileArray[t].nowait=!0,this._updateFileList()})}}else this._fileList.innerHTML="",this._info.style.display=""}_renderItem(t){const e=document.createElement("div");e.className="item",this._fileList.appendChild(e),e.innerHTML="";const i=document.createElement("div");i.className="name",e.appendChild(i),this._fileList.appendChild(e);const s=document.createElement("div");s.className="content",s.innerHTML=this._fileArray[t].name,e.appendChild(s);const a=document.createElement("div");a.className="support";const n=document.createElement("button"),l=document.createElement("span");l.className="mr-1",l.innerHTML=this._calcSize(this._fileArray[t].size),a.appendChild(l),n.className="br-button",n.type="button",n.setAttribute("circle",""),n.setAttribute("mini",""),n.addEventListener("click",()=>{this._removeFile(t,event)},!1);const o=document.createElement("i");o.className="fa fa-trash",n.appendChild(o),a.appendChild(n),e.appendChild(a),this._fileArray[t].nowait=!0}_calcSize(t){let e="";for(let i=["KB","MB","GB","TB"],s=0,a=t/1024;a>1;a/=1024,s++)e=`${a.toFixed(2)} ${i[s]}`;return e}_removeFile(t,e){e.stopPropagation(),e.preventDefault(),this._fileArray.splice(t,1),this._updateFileList()}}const uploadList=[];function uploadTimeout(){return new Promise(t=>setTimeout(t,3e3))}for(const t of window.document.querySelectorAll(".br-upload"))uploadList.push(new BRUpload("br-upload",t,uploadTimeout));export default BRUpload;
//# sourceMappingURL=upload.js.map