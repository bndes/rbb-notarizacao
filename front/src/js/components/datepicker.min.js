import datepicker from"js-datepicker";import{throwError}from"rxjs";class BRDatepicker{constructor(e,t,i){this.name=e,this.component=t,this._ERRO_1="Data inicial maior que data final ",this._ERRO_2="Data final maior que data inicial ",this._ERRO_3="Data deve ser superior a ",this._ERRO_4="Data deve ser inferior a ",this._ERRO_5="Data deve estar entre ",this._ERRO_5_AND=" e ",this._formatter=(e,t)=>{const i=t.toLocaleDateString("pt-BR");e.value=i},this._onShow=e=>{e.el.value=""},this._onHide=e=>{const t=this._validDate(e);e.dateSelected&&!t&&(e.el.value=e.dateSelected.toLocaleDateString("pt-BR"),this._validDate(e))},this._position="bl",this._customDays=["Dom","Seg","Ter","Qua","Qui","Sex","Sab"],this._customMonths=["Janeiro","Fevereiro","MarÃ§o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],this._customOverlayMonths=["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],this._overlayButtom="Confirma",this._overlayPlaceholder="Digite um ano",this._minDate=new Date(2019,0,1),this._respectDisabledReadOnly=!0,this._noWeekends=!1,this._disableYearOverlay=!0,this._id="dtp"+Math.floor(100*Math.random()),this._datepickerProperties=["onSelect","onShow","onHide","onMonthChange","formatter","position","startDay","customDays","customMonths","customOverlayMonths","overlayButtom","overlayPlaceholder","events","alwaysShow","dateSelected","maxDate","minDate","startDate","showAllDates","respectDisabledReadOnly","noWeekends","disabler","disableDates","disableMobile","disableYearOverlay","disabled","id"];for(const e of this.component.querySelectorAll("input"))this.picker=datepicker(e,this._configDatepicker(i));this._setBehavior()}_configDatepicker(e){const t={};for(const i of this._datepickerProperties)t[i]=e&&e[i]||this["_"+i];return t}_setBehavior(){for(const e of this.component.querySelectorAll("button.icon"))e.addEventListener("click",e=>{this._toggleDatepicker(e)});this.picker.el.addEventListener("keyup",e=>{this._maskDate(e)})}_toggleDatepicker(e){this.component.classList.contains("is-disabled")||(e.stopPropagation(),this.picker.calendarContainer.classList.contains("qs-hidden")?this.picker.show():this.picker.hide())}_maskDate(e){const t=e.target.value;if("Enter"===e.key)return this.picker.hide(),void this._focusNextElement();const i=t.replace(/\D/g,"").slice(0,8);i.length>=5?e.target.value=`${i.slice(0,2)}/${i.slice(2,4)}/${i.slice(4)}`:i.length>=3?e.target.value=`${i.slice(0,2)}/${i.slice(2)}`:e.target.value=i}_focusNextElement(){const e=Array.prototype.slice.call(document.querySelectorAll("input:not([disabled]):not([class='qs-overlay-year']), select")),t=(e.indexOf(document.activeElement)+1)%e.length,i=e[t];i.focus(),i.select()}_validDate(e){const t=e.el.value;let i;const a=[];try{i=e.getRange()}catch(e){throwError(e)}const s=new Date(t.split("/").reverse().join("/"));let o=!1;return isFinite(s)&&(o=!0,i&&(e.first?i.end&&(o=!(s>i.end),o||a.push(this._ERRO_1)):i.start&&(o=!(s<i.start),o||a.push(this._ERRO_2))),e.minDate&&e.maxDate?(o=!!(s>=e.minDate&&s<=e.maxDate),o||a.push(this._ERRO_5+e.minDate.toLocaleDateString()+this._ERRO_5_AND+e.maxDate.toLocaleDateString())):e.minDate?(o=s>=e.minDate,o||a.push(this._ERRO_3+e.minDate.toLocaleDateString())):e.maxDate&&(o=s<=e.maxDate,o||a.push(this._ERRO_4+e.maxDate.toLocaleDateString())),0===a.length?(e.setDate(s,1),this._showSucess(e)):this._showError(e,a)),a}_showError(e,t){this.component.classList.add("is-invalid"),this.component.classList.remove("is-valid");for(const e of this.component.parentNode.querySelectorAll("div.feedback.is-invalid span"))[e.innerText]=t}_showSucess(){this.component.classList.add("is-valid"),this.component.classList.remove("is-invalid")}disableDatepicker(){this.component.classList.add("is-disabled"),this.picker.el.disabled=!0}enableDatepicker(){this.component.classList.remove("is-disabled"),this.picker.el.disabled=!1}}const datepickerList=[];let configData={};for(const e of window.document.querySelectorAll(".br-datepicker"))e.classList.contains("range")?(configData={id:"range-1"},datepickerList.push(new BRDatepicker("br-datepicker",e,configData))):datepickerList.push(new BRDatepicker("br-datepicker",e));export default BRDatepicker;
//# sourceMappingURL=datepicker.js.map